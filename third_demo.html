<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8">
<title>Third demo</title>
<link rel="stylesheet" href="css.css">
</head>

<body>

<script src="main.js"></script>

<script type="text/javascript">
    var opposite = {"circle":"triangle", "triangle":"circle"};
    var winlose;
    var wins = 0;
    var losses = 0;
    var autoplayer;

    function executeStrategy(){
        choice = Math.random()>0.5 ? "circle" : "triangle";
        alice.say("circle");
        bob.say("circle");
        if (aliceCoin.outcome=="tails" && bobCoin.outcome=="tails")
        { losses += 1; } else { wins += 1; }


        var percent = (100*wins/(wins+losses)).toFixed(0);
        winlose.innerHTML = "Won " + wins + " games  / Lost " + losses + " games ("+ percent + "%)" ;

    }

    function autoplay(){
        haveTurn();
        clearInterval(autoplayer);
        autoplayer = setInterval(haveTurn, 1000);
    }

    function haveTurn(){
        alice.say(undefined);
        bob.say(undefined);
        aliceCoin.flip();
        bobCoin.flip();
    }

    window.onload = function(){
        boot();

        alice = new Person(images.alice, 150, 50, -1);
        bob = new Person(images.bob, gc.width-160, 50, 1);
        aliceCoin = new Coin(10, 100);
        bobCoin = new Coin(gc.width-50, 100);
        alice.afterSay = function(){locked=false;}

        rules = new Rules();
        aliceCoin.onLand = function(){ setTimeout(executeStrategy, 150); }
        gc.onclick = haveTurn;
        setInterval(update, 15);
    }

</script>

<canvas id=canvas width=600 height=150></canvas>

<div style="position:absolute; right:5px;">
    <a href="#" onclick="javascript:autoplay();">Autoplay</a>
</div>

<div id=winlose>
<div class="caption">Click anywhere in the figure to play a turn.</div>
</div> 

</body>
</html>
